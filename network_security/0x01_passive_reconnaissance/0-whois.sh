#!/bin/bash
whois $1 | awk 'BEGIN{FS=": "; OFS=""} /^Registrant Name:/,/^Registrant Email: /{if(/^(Registrant) (Name|Organization|Street|City|State\/Province|Postal Code|Country|Phone|Phone Ext|Fax|Fax Ext|Email):/){f=$1; v=$2; gsub(/: $/,"",f); if(f~/Phone Ext|Fax Ext/)f=f": "; print f", "v}} /^Admin Name:/,/^Admin Email: /{if(/^(Admin) (Name|Organization|Street|City|State\/Province|Postal Code|Country|Phone|Phone Ext|Fax|Fax Ext|Email):/){f=$1; v=$2; gsub(/:$/,"",f); if(f~/Phone Ext|Fax Ext/)f=f":"; print f", "v}} /^Tech Name:/,/^Tech Email:/{if(/^(Tech) (Name|Organization|Street|City|State\/Province|Postal Code|Country|Phone|Phone Ext|Fax|Fax Ext|Email):/){f=$1; v=$2; gsub(/:$/,"",f); if(f~/Phone Ext|Fax Ext/)f=f":"; print f", "v}}' > $1.csv
